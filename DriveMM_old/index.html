<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
	rel="stylesheet">

<link rel="stylesheet" href="./static/css/bulma.min.css">
<link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
<link rel="stylesheet" href="./static/css/bulma-slider.min.css">
<link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
<link rel="stylesheet" href="./static/css/index.css">
<link rel="icon" href="./static/images/icons/emova.png">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/progressive-image.js/dist/progressive-image.css">
<script src="http://www.google.com/jsapi" type="text/javascript"></script>
<script type="text/javascript">google.load("jquery", "1.3.2");</script>

<style type="text/css">
	body {
		font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
		font-weight: 300;
		font-size: 18px;
		margin-left: auto;
		margin-right: auto;
		width: 1100px;
	}

	h1 {
		font-size: 32px;
		font-weight: 300;
	}

	.disclaimerbox {
		background-color: #eee;
		border: 1px solid #eeeeee;
		border-radius: 10px;
		-moz-border-radius: 10px;
		-webkit-border-radius: 10px;
		padding: 20px;
	}

	video.header-vid {
		height: 140px;
		border: 1px solid black;
		border-radius: 10px;
		-moz-border-radius: 10px;
		-webkit-border-radius: 10px;
	}

	img.header-img {
		height: 140px;
		border: 1px solid black;
		border-radius: 10px;
		-moz-border-radius: 10px;
		-webkit-border-radius: 10px;
	}

	img.rounded {
		border: 1px solid #eeeeee;
		border-radius: 10px;
		-moz-border-radius: 10px;
		-webkit-border-radius: 10px;
	}

	a:link,
	a:visited {
		color: #1367a7;
		text-decoration: none;
	}

	a:hover {
		color: #208799;
	}

	td.dl-link {
		height: 160px;
		text-align: center;
		font-size: 22px;
	}

	.layered-paper-big {
		/* modified from: http://css-tricks.com/snippets/css/layered-paper/ */
		box-shadow:
			0px 0px 1px 1px rgba(0, 0, 0, 0.35),
			/* The top layer shadow */
			5px 5px 0 0px #fff,
			/* The second layer */
			5px 5px 1px 1px rgba(0, 0, 0, 0.35),
			/* The second layer shadow */
			10px 10px 0 0px #fff,
			/* The third layer */
			10px 10px 1px 1px rgba(0, 0, 0, 0.35),
			/* The third layer shadow */
			15px 15px 0 0px #fff,
			/* The fourth layer */
			15px 15px 1px 1px rgba(0, 0, 0, 0.35),
			/* The fourth layer shadow */
			20px 20px 0 0px #fff,
			/* The fifth layer */
			20px 20px 1px 1px rgba(0, 0, 0, 0.35),
			/* The fifth layer shadow */
			25px 25px 0 0px #fff,
			/* The fifth layer */
			25px 25px 1px 1px rgba(0, 0, 0, 0.35);
		/* The fifth layer shadow */
		margin-left: 10px;
		margin-right: 45px;
	}

	.paper-big {
		/* modified from: http://css-tricks.com/snippets/css/layered-paper/ */
		box-shadow:
			0px 0px 1px 1px rgba(0, 0, 0, 0.35);
		/* The top layer shadow */

		margin-left: 10px;
		margin-right: 45px;
	}


	.layered-paper {
		/* modified from: http://css-tricks.com/snippets/css/layered-paper/ */
		box-shadow:
			0px 0px 1px 1px rgba(0, 0, 0, 0.35),
			/* The top layer shadow */
			5px 5px 0 0px #fff,
			/* The second layer */
			5px 5px 1px 1px rgba(0, 0, 0, 0.35),
			/* The second layer shadow */
			10px 10px 0 0px #fff,
			/* The third layer */
			10px 10px 1px 1px rgba(0, 0, 0, 0.35);
		/* The third layer shadow */
		margin-top: 5px;
		margin-left: 10px;
		margin-right: 30px;
		margin-bottom: 5px;
	}

	.vert-cent {
		position: relative;
		top: 50%;
		transform: translateY(-50%);
	}

	hr {
		border: 0;
		height: 1px;
		background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));
	}
</style>

<html>

<head>
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-WJFX2BFB9X"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag() { dataLayer.push(arguments); }
		gtag('js', new Date());

		gtag('config', 'G-WJFX2BFB9X');
	</script>
	<title>DriveMM: All-in-One Large Multimodal Model for Autonomous Driving</title>
	<meta property="og:image" content="./resources/overview.png" />
	<!-- Facebook automatically scrapes this. Go to https://developers.facebook.com/tools/debug/ if you update and want to force Facebook to rescrape. -->
	<meta property="og:title" content="DriveMM: All-in-One Large Multimodal Model for Autonomous Driving" />
	<meta property="og:description" content="Z. Huang, C. Fen, F. Yan, B. Xiao, Z. Jie, Y. Zhong, X. Liang, L. Ma" />

	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<!-- <style>
		.chat-history {
		  flex-grow: 1;
		  overflow-y: auto;
		  /* overflow-x: hidden; */
		  padding: 5px;
		  border-bottom: 1px solid #ccc;
		  margin-bottom: 10px;
		  text-align: left; 
		}
	  
	</style> -->
	<style>
		.chat-history {
			flex-grow: 1;
			overflow-y: auto;
			/* overflow-x: hidden; */
			padding: 5px;
			border-bottom: 1px solid #ccc;
			margin-bottom: 10px;
			text-align: left;
		}

		.chat-history img {
			display: none;
			max-width: 100%;
			max-height: 100%;
		}

		.chat-history img.active {
			display: block;
		}
	</style>
</head>




<body>
	<br>
	<center>
		<span style="font-size:38px; font-weight:bold;">DriveMM: All-in-One Large Multimodal Model for Autonomous
			Driving</span>
		<br>
		<br>

		<table align=center width=1000px>
			<table align=center width=1000px>
				<tr>
					<td align=center width=200px>
						<center>
							<span style="font-size:22px"><a href="https://zhijian11.github.io/">
									Zhijian Huang</a><sup>1*</sup></span>
						</center>
					</td>
					<td align=center width=200px>
						<center>
							<span style="font-size:22px"><a href="https://fcjian.github.io/">
									Chengjian Feng</a><sup>2*</sup></span>
						</center>
					</td>
					<td align=center width=200px>
						<center>
							<span style="font-size:22px"><a
									href="https://scholar.google.com.hk/citations?user=gO4divAAAAAJ&hl=zh-CN&oi=sra">
									Fen Yan</a><sup>2</sup></span>
						</center>
					</td>
					<td align=center width=200px>
						<center>
							<span style="font-size:22px"><a href="xbh23@mails.tsinghua.edu.cn">
									Baihui Xiao</a><sup>2</sup></span>
						</center>
					</td>
					<td align=center width=200px>
						<center>
							<span style="font-size:22px"><a
									href="https://scholar.google.com/citations?user=4sKGNB0AAAAJ&hl=zh-CN&oi=ao">
									Zequn Jie</a><sup>2</sup></span>
						</center>
					</td>
				</tr>
			</table>
			<table align=center width=600px>
				<tr>
					<td align=center width=200px>
						<center>
							<span style="font-size:22px"><a href="https://y-zhong.info/">
									Yujie Zhong</a><sup>2</sup></span>
						</center>
					</td>
					<td align=center width=200px>
						<center>
							<span style="font-size:22px"><a href="https://lemondan.github.io/">
									Xiaodan Liang</a><sup>1<img class="round" style="width:20px"
										src="./resources/email_flag.png" /></sup></span>
						</center>
					</td>
					<td align=center width=200px>
						<center>
							<span style="font-size:22px"><a href="http://forestlinma.com/">
									Lin Ma</a><sup>2<img class="round" style="width:20px"
										src="./resources/email_flag.png" /></sup></span>
						</center>
					</td>
				</tr>
			</table>

			</tbody>
		</table><br>
		<table align="center" width="800px">
			<tbody>
				<tr>
					<td align="center" width="500px">
						<center>
							<span style="font-size:22px"><sup>1</sup>Shenzhen Campus of Sun Yat-sen University</span>
						</center>
					</td>
					<td align="center" width="300px">
						<center>
							<span style="font-size:22px"><sup>2</sup>Meituan Inc.</span>
						</center>
					</td>
				</tr>
			</tbody>
		</table>

		<!-- <br>
			<table align=center width=500px>
				<tr>
					<td align=center width=500px>
						<center>
							<span style="font-size:22px">
								<span style="font-size:22px"><em>ECCV</em> 2024<font color="red"><strong>(Oral)</strong></font>
								</span>
							</span>
						</center>
					</td>
				</tr>
			</table> -->
		

		<table align=center width=250px>
			<br>
			<tr>
				<span style="font-size:22px">
					<a href="">ArXiv</a> |
					<a href="">Code</a> |
					<a href="">Bibtex</a><br>
				</span>
			</tr>
		</table>
		</table>
	</center>
	<br>
	<center>
		<table align=center width=500px>
			<tr>
				<td width=500px>
					<center>
						<img src="./resources/overview.png" alt="clean-usnob" width="1050">
					</center>
				</td>
			</tr>
		</table>

	</center>

	<hr>

	<table align=center width=850px>
		<center>
			<h1>Abstract</h1>
		</center>
		<tr>
			<td>
				Large Multimodal Models (LMMs) have demonstrated exceptional comprehension and interpretation
				capabilities in Autonomous Driving (AD) by incorporating large language models.
				Despite the advancements, current data-driven AD approaches tend to concentrate on a single dataset and
				specific tasks, neglecting their overall capabilities and ability to generalize.
				To bridge these gaps, we propose DriveMM, a general large multimodal model designed to process diverse
				data inputs, such as images and multi-view videos, while performing a broad spectrum of AD tasks,
				including perception, prediction, and planning.
				Initially, the model undergoes curriculum pre-training to process varied visual signals and perform
				basic visual comprehension and perception tasks.
				Subsequently, we augment and standardize various AD-related datasets to fine-tune the model, resulting
				in an all-in-one LMM for autonomous driving.
				To assess the general capabilities and generalization ability, we conduct evaluations on six public
				benchmarks and undertake zero-shot transfer on an unseen dataset, where DriveMM achieves
				state-of-the-art performance across all tasks.
				We hope DriveMM as a promising solution for future end-toend autonomous driving applications in the real
				world.
			</td>
		</tr>
	</table>
	<br>

	<hr>
	<center>
		<h1>Methodology</h1>
	</center>

	<table align=center width=850px>
		<tr>
			<td>
				We adapt the architecture form of LLaVA with a different model instantiation, processing various visual
				input signals.
				We design a perspective-aware prompt to accept multi-perspective inputs in AD scenario.
				Equipped with diverse AD multimodal data, DriveMM possesses an all-in-one capability to accomplish
				multiple tasks in autonomous driving.
			</td>
		</tr>
	</table>
	<table align=center width=750px>
		<center>
			<tr>
				<td>
					<center>
				<td><img class="round" style="width:850px" src="./resources/method.png" /></td>
		</center>
		</td>
		</tr>
		</center>
	</table>

	<hr>
	<center>
		<h1>Results & Visualizations</h1>
	</center>

	<table align=center width=850px>
		<tr>
			<td>
				<b>R1</b>: General performance on benchmarks. We compare with state-of-the-art specialist models,
				commercial models and open-source large multimodal models across diverse autonomous driving valuation
				benchmarks spanning multiple modalities.
				<br><sup>†</sup>Specialist models correspond to the performance of six different models.
				<br><sup>∗</sup> indicates max((Accuracy+MAP+BLEU-MAE)/4, 0).
		</tr>
	</table>
	<table align=center width=700px>
		<center>
			<tr>
				<td>
					<center>
				<td><img class="round" style="width:700px" src="./resources/general_result.png" /></td>
		</center>
		</td>
		</tr>
		</center>
	</table>

	<br>
	<table align=center width=850px>
		<tr>
			<td>
				<b>R2</b>: Generalization ability in BDD-X. Specialists are fine-tuned on a single dataset, whereas
				DriveMM is fine-tuned on all datasets.
		</tr>
	</table>
	<table align=center width=700px>
		<center>
			<tr>
				<td>
					<center>
				<td><img class="round" style="width:700px" src="./resources/generalization_result.png" /></td>
		</center>
		</td>
		</tr>
		</center>
	</table>

	<div class="container mt-0" style="width: 100%;">
		<div class="form-row" style="justify-content: center;">
			<div class="form-group col-md-1">
				<div class="col-md-2" style="width: 100%"><label>&nbsp;</label></div>
				<div class="btn-group" role="group" aria-label="Left and Right Controller"
					style="width: 100%;align-items: flex-end;justify-content: center;flex-direction: row;display: flex;">
					<button type="button" class="form-control btn btn-primary" id="prev-question"><i
							class="material-icons">keyboard_arrow_left</i></button>
					<button type="button" class="form-control btn btn-primary" id="next-question"><i
							class="material-icons">keyboard_arrow_right</i></button>
				</div>
			</div>
		</div>
		<div style="display: flex; justify-content: center; align-items: center;">
			<div class="card mb-4" style="width: 80%; display: flex; align-items: center;">
				<div class="card-body" id="selected-question" style="display: flex; height: 100vh;">
					<div class="chat-history">
						<article class="media">
							<img src="./resources/visualization/codalm1.png" class="active">
						</article>
						<article class="media">
							<img src="./resources/visualization/codalm2.png">
						</article>
						<article class="media">
							<img src="./resources/visualization/codalm3.png">
						</article>
						<article class="media">
							<img src="./resources/visualization/maplm1.png">
						</article>
						<article class="media">
							<img src="./resources/visualization/drivelm1.png">
						</article>
						<article class="media">
							<img src="./resources/visualization/drivelm2.png">
						</article>
						<article class="media">
							<img src="./resources/visualization/lingoqa1.png">
						</article>
						<article class="media">
							<img src="./resources/visualization/lingoqa2.png">
						</article>
						<article class="media">
							<img src="./resources/visualization/omnidrive1.png">
						</article>
						<article class="media">
							<img src="./resources/visualization/omnidrive2.png">
						</article>
						<article class="media">
							<img src="./resources/visualization/nuinstruct1.png">
						</article>
						<article class="media">
							<img src="./resources/visualization/nuinstruct2.png">
						</article>
						<article class="media">
							<img src="./resources/visualization/nuinstruct3.png">
						</article>
						<article class="media">
							<img src="./resources/visualization/nuinstruct4.png">
						</article>
						<article class="media">
							<img src="./resources/visualization/bddx1.png">
						</article>
						<article class="media">
							<img src="./resources/visualization/bddx2.png">
						</article>
					</div>
				</div>
			</div>
		</div>
	</div>


	<!-- <br> -->

	<table align=center width=750px>
		<center>
			<tr>
				<td>
					<center>
						<table align=center width=850px>
							<center>
								<tr>
								</tr>
							</center>
						</table>


						<hr>
						<table align=center width=800px>
							<center>
								<h1>Publication</h1>
							</center>
							<tr>
								<td><a href=""><img class="layered-paper-big" style="height:175px"
											src="./resources/paper.png" /></a></td>
								<td><span style="font-size:14pt">Z. Huang, C. Feng, F. Yan, B. Xiao, Z. Jie, Y. Zhong,
										X. Liang, L. Ma<br>
										<b>DriveMM: All-in-One Large Multimodal Model for Autonomous Driving</b><br>
										<!-- <em>ECCV</em> 2024<font color="red"><strong>(Oral)</strong></font> -->
										<!-- <br> -->
										<a href="">ArXiv</a> |
										<a href="">Code</a> |
										<a href="">Bibtex</a><br>
										<br>
										<!-- (<a href="./resources/camera-ready.pdf">camera ready</a>)<br> -->
										<span style="font-size:4pt"><a href=""><br></a>
										</span>
								</td>
							</tr>
						</table>
						<br>
						<br>

						<table
							style="width:95%;border:0px;border-spacing:0px;border-collapse:separate;margin-right:auto;margin-left:auto;">
							<tbody>
								<tr>
									<td style="padding:0px">
										<br>
										<p style="text-align:right;font-size:small;">
											Webpage template modified from <a
												href="https://github.com/richzhang/webpage-template/">here</a>.
										</p>
									</td>
								</tr>
							</tbody>
						</table>

						<br>
					</center>
				</td>
			</tr>
		</center>
	</table>

	<!-- <script>
		// Handle message showing
		function createChatRow(sender, text, imageSrc, audioSrc, transcription) {
		var article = document.createElement("article");
		article.className = "media"
	
		var figure = document.createElement("figure");
		figure.className = "media-left";
	
		var span = document.createElement("span");
		span.className = "icon is-large";
	
	
		
		if (sender === "User") {
			var icon = document.createElement("i");
			
			icon.className = "fa-solid fa-2x" + (sender === "User" ? " fa-user " : sender === "LLaVA-1.5 (Direct response)" ? " fa-robot " : sender === "LLaVA-1.5 (ECSO-caption)" ? " fa-shield" : sender === "LLaVA-1.5 (ECSO-response)" ? " fa-shield" : sender === "mPLUG-Owl2 (Direct response)" ? " fa-robot " : sender === "mPLUG-Owl2 (ECSO-caption)" ? " fa-shield" : sender === "mPLUG-Owl2 (ECSO-response)" ? " fa-shield" : sender === "Qwen-VL-Chat (Direct response)" ? " fa-robot " : sender === "Qwen-VL-Chat (ECSO-caption)" ? " fa-shield" : sender === "Qwen-VL-Chat (ECSO-response)" ? " fa-shield" : sender === "ShareGPT4V (Direct response)" ? " fa-robot " : sender === "ShareGPT4V (ECSO-caption)" ? " fa-shield" : sender === "ShareGPT4V (ECSO-response)" ? " fa-shield" : sender === "MiniGPT-4 (Direct response)" ? " fa-robot " : sender === "MiniGPT-4 (ECSO-caption)" ? " fa-shield" : sender === "MiniGPT-4 (ECSO-response)" ? " fa-shield" : "");
		}
		else {
			var icon = document.createElement("img");
			icon.className = "custom-icon"; // Add any desired classes for styling
			icon.src = getIconSrc(sender); // Function to determine icon source based on sender
		}
	
		
		var media = document.createElement("div");
		media.className = "media-content";
	
		var content = document.createElement("div");
		content.className = "content";
	
		var para = document.createElement("p");
	
		// wrap text in pre tag to preserve whitespace and line breaks
		var pre_text = document.createElement("pre");
		pre_text.style = "background-color: white; font-size: 18px; font-family: Arial; padding: 0; margin: 0; white-space: pre-wrap; word-wrap: break-word;";
		var paraText = document.createTextNode(text);
		pre_text.appendChild(paraText);
	
		var strong = document.createElement("strong");
		strong.innerHTML = sender;
		var br = document.createElement("br");
	
		para.appendChild(strong);
		para.appendChild(br);
		
	
		// Add image if imageSrc is provided
		if (imageSrc) {
			var img = document.createElement("img");
			img.src = imageSrc;
			img.style = "max-width: 700px; max-height: 800px;";
			para.appendChild(img); // Append image first
		}
	
		// Add audio if audioSrc is provided
		if (audioSrc) {
			var audio = document.createElement("audio");
			audio.controls = true;
			audio.style = "display: block; margin-top: 10px auto;"; // Ensure audio is block-level and centered
	
			var source = document.createElement("source");
			source.src = audioSrc; // Ensure this points to your WAV file
			source.type = "audio/wav"; // Set the correct type for WAV files
	
			audio.appendChild(source);
			para.appendChild(audio); // Append audio after the image
		}
		
		if (transcription) {
			// wrap text in pre tag to preserve whitespace and line breaks
			var pre_trans = document.createElement("pre");
			pre_trans.style = "background-color: white; font-size: 18px; font-family: Arial; padding: 0; margin: 0; white-space: pre-wrap; word-wrap: break-word;";
			var paraTranscription = document.createTextNode(transcription);
			pre_trans.appendChild(paraTranscription);
			para.appendChild(pre_trans);
		}
	
		para.appendChild(pre_text);
	
		content.appendChild(para);
		media.appendChild(content);
		span.appendChild(icon);
		figure.appendChild(span);
		if (sender !== "Description") {
			article.appendChild(figure);
		};
		article.appendChild(media);
		return article;
		}
		
		function getIconSrc(sender) {
		switch (sender) {
			case "User":
				return ""; // Replace with your own image path
			case "EMOVA":
				return "./static/images/icons/emova.png"; // Default icon if no match
			// Add cases for other senders with their corresponding image paths
			default:
				return ""; // Default icon if no match
		}
		}

		let currentIndex = 0;

		function addMessageToChatHistory(sender, message, imageSrc, audioSrc, transcription) {
			const chatHistory = document.querySelector('.chat-history');
			const chatRow = createChatRow(sender, message, imageSrc, audioSrc, transcription);
			chatHistory.appendChild(chatRow);
			chatHistory.scrollTop = chatHistory.scrollHeight;
		}
		
		function clearChatHistory() {
			const chatHistory = document.querySelector('.chat-history');
			chatHistory.innerHTML = "";
		}

		
		// The function to update the displayed chat history
		function update_dialog_demo() {
		// Clear the chat history
		clearChatHistory();

		for (let i = 0; i < conversations[currentIndex].turns.length; i++) {
			if (conversations[currentIndex].turns[i].length == 2) {
			addMessageToChatHistory(conversations[currentIndex].turns[i][0], conversations[currentIndex].turns[i][1]);
			} else if (conversations[currentIndex].turns[i].length == 3) {
			addMessageToChatHistory(conversations[currentIndex].turns[i][0], conversations[currentIndex].turns[i][1], conversations[currentIndex].turns[i][2]);
			}
			else {
			addMessageToChatHistory(conversations[currentIndex].turns[i][0], conversations[currentIndex].turns[i][1], conversations[currentIndex].turns[i][2], conversations[currentIndex].turns[i][3], conversations[currentIndex].turns[i][4])
			}
		}

		// scroll to the top of the chat history
		document.querySelector('.chat-history').scrollTop = 0;
		}

		update_dialog_demo;
		document.getElementById('prev-question').addEventListener('click', () => {
			currentIndex = (currentIndex - 1 + conversations.length) % conversations.length;
			update_dialog_demo();
		});
		
		document.getElementById('next-question').addEventListener('click', () => {
		currentIndex = (currentIndex + 1) % conversations.length;
		update_dialog_demo();
		});
	</script> -->
	<script>
		document.addEventListener('DOMContentLoaded', function () {
			const images = document.querySelectorAll('.chat-history img');
			let currentIndex = 0;

			document.getElementById('prev-question').addEventListener('click', function () {
				images[currentIndex].classList.remove('active');
				currentIndex = (currentIndex === 0) ? images.length - 1 : currentIndex - 1;
				images[currentIndex].classList.add('active');
			});

			document.getElementById('next-question').addEventListener('click', function () {
				images[currentIndex].classList.remove('active');
				currentIndex = (currentIndex === images.length - 1) ? 0 : currentIndex + 1;
				images[currentIndex].classList.add('active');
			});
		});
	</script>
</body>

</html>